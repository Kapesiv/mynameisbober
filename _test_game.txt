import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/Game.ts");        import "/@fs/C:/Users/kappu/saab/node_modules/@prefresh/core/src/index.js?v=89f8e5f1";        import { flush as flushUpdates } from "/@fs/C:/Users/kappu/saab/node_modules/@prefresh/utils/src/index.js?v=89f8e5f1";        let prevRefreshReg;        let prevRefreshSig;        if (import.meta.hot) {          prevRefreshReg = self.$RefreshReg$ || (() => {});          prevRefreshSig = self.$RefreshSig$ || (() => (type) => type);          self.$RefreshReg$ = (type, id) => {            self.__PREFRESH__.register(type, "C:/Users/kappu/saab/client/src/Game.ts" + " " + id);          };          self.$RefreshSig$ = () => {            let status = 'begin';            let savedType;            return (type, key, forceReset, getCustomHooks) => {              if (!savedType) savedType = type;              status = self.__PREFRESH__.sign(type || savedType, key, forceReset, getCustomHooks, status);              return type;            };          };        }        import * as THREE from "/node_modules/.vite/deps/three.js?v=89f8e5f1";
import { Renderer } from "/src/core/Renderer.ts";
import { SceneManager } from "/src/core/SceneManager.ts";
import { CameraController } from "/src/core/CameraController.ts";
import { InputManager } from "/src/core/InputManager.ts";
import { NetworkManager } from "/src/network/NetworkManager.ts";
import { LocalPlayer } from "/src/entities/LocalPlayer.ts";
import { RemotePlayer } from "/src/entities/RemotePlayer.ts";
import { MonsterEntity } from "/src/entities/Monster.ts";
import { LootDropEntity } from "/src/entities/LootDrop.ts";
import { HubWorld } from "/src/world/HubWorld.ts";
import { mountHUD } from "/src/ui/HUD.tsx";
import { mountNPCDialog, showNPCDialog, hideNPCDialog } from "/src/ui/NPCDialog.tsx";
import { mountMiniMap } from "/src/ui/MiniMap.tsx";
import { mountShopPanel, showShopPanel, hideShopPanel } from "/src/ui/ShopPanel.tsx";
import { mountInventoryPanel, toggleInventoryPanel, hideInventoryPanel } from "/src/ui/InventoryPanel.tsx";
import { mountSettingsMenu, showSettings, hideSettings, isSettingsOpen } from "/src/ui/SettingsMenu.tsx";
import { MusicSystem } from "/src/systems/MusicSystem.ts";
import { inventoryManager } from "/src/systems/InventoryManager.ts";
import { setNetworkManager } from "/src/network/actions.ts";
import { CLIENT_INPUT_RATE } from "/@fs/C:/Users/kappu/saab/packages/shared/src/index.ts";
export class Game {
  renderer;
  sceneManager;
  camera;
  input;
  network;
  localPlayer = null;
  remotePlayers = /* @__PURE__ */new Map();
  monsters = /* @__PURE__ */new Map();
  lootDrops = /* @__PURE__ */new Map();
  hubWorld = null;
  music = new MusicSystem();
  clock = new THREE.Clock();
  elapsedTime = 0;
  inputTimer = 0;
  inputInterval = 1 / CLIENT_INPUT_RATE;
  fps = 0;
  frameCount = 0;
  fpsTimer = 0;
  currentRoom = "hub";
  hudState = null;
  playerName = "Adventurer";
  playerGender = "male";
  portalCooldown = 0;
  // prevent spam
  npcCooldown = 0;
  isMoving = false;
  paused = false;
  canvas;
  constructor(canvas) {
    this.canvas = canvas;
    this.renderer = new Renderer(canvas);
    this.sceneManager = new SceneManager();
    this.camera = new CameraController();
    this.input = new InputManager(canvas);
    this.network = new NetworkManager();
    setNetworkManager(this.network);
    const uiOverlay = document.getElementById("ui-overlay");
    mountHUD(uiOverlay, () => this.hudState);
    mountNPCDialog(uiOverlay);
    mountMiniMap(uiOverlay, () => this.getMinimapData());
    mountShopPanel(uiOverlay);
    mountInventoryPanel(uiOverlay);
    mountSettingsMenu(uiOverlay, {
      onSoundToggle: muted => {
        if (muted) this.music.mute();else this.music.unmute();
      },
      onResume: () => this.unpause()
    });
    window.addEventListener("keydown", e => {
      if (e.code === "Escape") {
        if (isSettingsOpen()) {
          hideSettings();
        } else if (this.isAnyPanelOpen()) {
          hideNPCDialog();
          hideShopPanel();
          hideInventoryPanel();
        } else {
          this.pause();
        }
      }
      if (e.code === "KeyI" || e.code === "KeyB") {
        if (!this.paused) toggleInventoryPanel();
      }
    });
  }
  isAnyPanelOpen() {
    const npcRoot = document.getElementById("npc-dialog-root");
    const shopRoot = document.getElementById("shop-panel-root");
    const invRoot = document.getElementById("inventory-panel-root");
    return !!(npcRoot && npcRoot.children.length > 0 && npcRoot.innerHTML.length > 10 || shopRoot && shopRoot.children.length > 0 && shopRoot.innerHTML.length > 10 || invRoot && invRoot.children.length > 0 && invRoot.innerHTML.length > 10);
  }
  pause() {
    this.paused = true;
    showSettings();
    document.exitPointerLock();
  }
  unpause() {
    this.paused = false;
    this.canvas.requestPointerLock();
  }
  async connect(playerName, gender = "male") {
    this.playerName = playerName;
    this.playerGender = gender;
    this.network.onMessage = (type, data) => this.handleMessage(type, data);
    this.hubWorld = new HubWorld(this.sceneManager.scene);
    const room = await this.network.joinRoom("hub", {
      name: playerName
    });
    this.localPlayer = new LocalPlayer(this.sceneManager.scene, gender);
    this.setupRoomListeners(room);
    this.currentRoom = "hub";
    this.music.playHub();
    this.renderer.setupPostProcessing(this.sceneManager.scene, this.camera.camera);
    this.startLoop();
  }
  setupRoomListeners(room) {
    room.state.players.onAdd((player, sessionId) => {
      if (sessionId === this.network.getSessionId()) return;
      const remote = new RemotePlayer(this.sceneManager.scene, sessionId, player.name);
      remote.targetPosition.set(player.position.x, player.position.y, player.position.z);
      this.remotePlayers.set(sessionId, remote);
      player.position.onChange(() => {
        remote.targetPosition.set(player.position.x, player.position.y, player.position.z);
        remote.targetRotation = player.rotation;
      });
    });
    room.state.players.onRemove((_player, sessionId) => {
      const remote = this.remotePlayers.get(sessionId);
      if (remote) {
        remote.dispose(this.sceneManager.scene);
        this.remotePlayers.delete(sessionId);
      }
    });
    if (room.state.monsters) {
      room.state.monsters.onAdd((monster, id) => {
        const entity = new MonsterEntity(this.sceneManager.scene, id, monster.defId);
        entity.targetPosition.set(monster.position.x, monster.position.y, monster.position.z);
        entity.hp = monster.hp;
        entity.maxHp = monster.maxHp;
        this.monsters.set(id, entity);
        monster.position.onChange(() => {
          entity.targetPosition.set(monster.position.x, monster.position.y, monster.position.z);
          entity.targetRotation = monster.rotation;
        });
        monster.onChange(() => {
          entity.hp = monster.hp;
          entity.maxHp = monster.maxHp;
        });
      });
      room.state.monsters.onRemove((_monster, id) => {
        const entity = this.monsters.get(id);
        if (entity) {
          entity.dispose(this.sceneManager.scene);
          this.monsters.delete(id);
        }
      });
    }
    if (room.state.lootDrops) {
      room.state.lootDrops.onAdd((loot, id) => {
        const entity = new LootDropEntity(this.sceneManager.scene, id, loot.itemDefId, loot.rarity, loot.x, loot.y, loot.z);
        this.lootDrops.set(id, entity);
      });
      room.state.lootDrops.onRemove((_loot, id) => {
        const entity = this.lootDrops.get(id);
        if (entity) {
          entity.dispose(this.sceneManager.scene);
          this.lootDrops.delete(id);
        }
      });
    }
  }
  async switchRoom(roomType, options = {}) {
    this.remotePlayers.forEach(p => p.dispose(this.sceneManager.scene));
    this.remotePlayers.clear();
    this.monsters.forEach(m => m.dispose(this.sceneManager.scene));
    this.monsters.clear();
    this.lootDrops.forEach(l => l.dispose(this.sceneManager.scene));
    this.lootDrops.clear();
    if (this.hubWorld) {
      this.hubWorld.group.visible = roomType === "hub";
    }
    const room = await this.network.joinRoom(roomType, {
      ...options,
      name: this.playerName
    });
    this.setupRoomListeners(room);
    if (this.localPlayer) {
      this.localPlayer.position.set(0, roomType === "hub" ? 0.91 : 0, roomType === "dungeon" ? -8 : 16);
    }
    this.currentRoom = roomType;
    this.portalCooldown = 1;
    if (roomType === "hub") this.music.playHub();else this.music.playDungeon();
  }
  handleMessage(type, data) {
    if (type === "damage") {} else if (type === "level_up") {
      console.log(`Level up! Now level ${data.level}`);
    } else if (type === "loot_acquired") {
      if (data.item) {
        inventoryManager.addItem(data.item);
        console.log(`Picked up: ${data.item.defId} (${data.item.rarity})`);
      }
    } else if (type === "player_died") {
      if (data.playerId === this.network.getSessionId() && this.localPlayer) {
        this.localPlayer.position.set(0, 0, -8);
      }
    } else if (type === "inventory_full") {
      inventoryManager.setFull(data.items, data.gold);
    } else if (type === "gold_gained") {
      inventoryManager.setGold(data.total);
    } else if (type === "shop_buy_ok") {
      inventoryManager.addItem(data.item);
      inventoryManager.setGold(data.gold);
    } else if (type === "shop_buy_fail") {
      console.log(`Shop buy failed: ${data.error}`);
    } else if (type === "shop_sell_ok") {
      inventoryManager.removeItem(data.instanceId);
      inventoryManager.setGold(data.gold);
    } else if (type === "shop_sell_fail") {
      console.log(`Shop sell failed: ${data.error}`);
    }
  }
  startLoop() {
    const loop = () => {
      requestAnimationFrame(loop);
      const dt = this.clock.getDelta();
      this.elapsedTime += dt;
      this.update(dt);
      this.renderer.render(this.sceneManager.scene, this.camera.camera);
    };
    loop();
  }
  update(dt) {
    this.frameCount++;
    this.fpsTimer += dt;
    if (this.fpsTimer >= 1) {
      this.fps = this.frameCount;
      this.frameCount = 0;
      this.fpsTimer = 0;
    }
    if (this.paused) return;
    this.portalCooldown = Math.max(0, this.portalCooldown - dt);
    this.npcCooldown = Math.max(0, this.npcCooldown - dt);
    const mouse = this.input.consumeMouse();
    this.camera.onMouseMove(mouse.dx, mouse.dy);
    this.inputTimer += dt;
    if (this.inputTimer >= this.inputInterval && this.localPlayer) {
      this.inputTimer = 0;
      const input = this.input.getInput(this.camera.getYaw(), this.inputInterval);
      this.localPlayer.applyInput(input);
      this.network.sendInput(input);
      this.isMoving = input.forward || input.backward || input.left || input.right;
    }
    const room = this.network.getRoom();
    if (room && this.localPlayer) {
      const myState = room.state.players?.get(this.network.getSessionId());
      if (myState) {
        this.localPlayer.reconcile(myState.position.x, myState.position.z, myState.lastProcessedInput);
        this.hudState = {
          hp: myState.stats?.hp ?? 100,
          maxHp: myState.stats?.maxHp ?? 100,
          mana: myState.stats?.mana ?? 50,
          maxMana: myState.stats?.maxMana ?? 50,
          level: myState.stats?.level ?? 1,
          xp: myState.stats?.xp ?? 0,
          xpToNext: myState.stats?.xpToNext ?? 100,
          gold: inventoryManager.getGold(),
          playerCount: room.state.players?.size ?? 0,
          roomType: this.currentRoom,
          fps: this.fps
        };
      }
    }
    this.localPlayer?.update(dt, this.elapsedTime, this.isMoving);
    this.remotePlayers.forEach(p => p.update(dt));
    this.monsters.forEach(m => m.update(dt));
    this.lootDrops.forEach(l => l.update(dt));
    if (this.localPlayer) {
      this.camera.update(this.localPlayer.position, dt);
    }
    if (this.hubWorld && this.currentRoom === "hub") {
      this.hubWorld.update(this.elapsedTime, this.localPlayer?.position);
    }
    this.checkInteractions();
  }
  checkInteractions() {
    if (!this.localPlayer) return;
    const pos = this.localPlayer.position;
    if (this.currentRoom === "hub" && this.hubWorld) {
      if (this.input.isKey("KeyE") && this.portalCooldown <= 0) {
        const portalDist = pos.distanceTo(this.hubWorld.forestPortalPosition);
        if (portalDist < 4) {
          this.switchRoom("dungeon", {
            dungeonId: "forest"
          });
          return;
        }
      }
      if (this.input.isKey("KeyE") && this.npcCooldown <= 0) {
        for (const npc of this.hubWorld.npcPositions) {
          const dist = pos.distanceTo(npc.position);
          if (dist < 3) {
            if (npc.name === "Blacksmith Toivo") {
              showShopPanel();
            } else {
              showNPCDialog(npc.name, npc.dialog);
            }
            this.npcCooldown = 0.5;
            break;
          }
        }
      }
    }
    if (this.currentRoom === "dungeon") {
      if (this.input.isKey("KeyF")) {
        let closestId = null;
        let closestDist = 3;
        this.lootDrops.forEach((loot, id) => {
          const dist = pos.distanceTo(loot.mesh.position);
          if (dist < closestDist) {
            closestDist = dist;
            closestId = id;
          }
        });
        if (closestId) {
          this.network.sendMessage("pickup", {
            lootId: closestId
          });
        }
      }
      if (this.input.isKey("KeyQ") && this.portalCooldown <= 0) {
        this.switchRoom("hub");
      }
    }
  }
  getMinimapData() {
    if (!this.localPlayer) return null;
    const remotePlayers = [];
    this.remotePlayers.forEach(rp => {
      remotePlayers.push({
        x: rp.targetPosition.x,
        z: rp.targetPosition.z
      });
    });
    const npcs = [];
    const portals = [];
    if (this.currentRoom === "hub" && this.hubWorld) {
      for (const npc of this.hubWorld.npcPositions) {
        npcs.push({
          x: npc.position.x,
          z: npc.position.z,
          name: npc.name
        });
      }
      portals.push({
        x: 0,
        z: -25,
        color: "#ff8800"
      },
      // Forest portal
      {
        x: -10,
        z: -25,
        color: "#ff8800"
      },
      // Ice Caves
      {
        x: 10,
        z: -25,
        color: "#ff8800"
      },
      // Volcano
      {
        x: -12,
        z: -5,
        color: "#ffdd00"
      },
      // Shop
      {
        x: 15,
        z: -8,
        color: "#ff4444"
      }
      // PvP Arena
      );
    }
    const monsters = [];
    this.monsters.forEach(m => {
      monsters.push({
        x: m.targetPosition.x,
        z: m.targetPosition.z
      });
    });
    return {
      playerX: this.localPlayer.position.x,
      playerZ: this.localPlayer.position.z,
      playerYaw: this.camera.getYaw(),
      remotePlayers,
      npcs,
      portals,
      monsters,
      roomType: this.currentRoom
    };
  }
}
_c = Game;
var _c;
$RefreshReg$(_c, "Game");

        if (import.meta.hot) {
          self.$RefreshReg$ = prevRefreshReg;
          self.$RefreshSig$ = prevRefreshSig;
          import.meta.hot.accept((m) => {
            try {
              flushUpdates();
            } catch (e) {
              console.log('[PREFRESH] Failed to flush updates:', e);
              self.location.reload();
            }
          });
        }
      
//# sourceMappingURL=data:application/json;base64,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QUtuTCxPQUFPeUksT0FBTztNQUM5QnJJO01BQ0EwSztNQUNBQztNQUNBeks7TUFDQTZGLFVBQVUsS0FBS2pGO0lBQ2pCO0VBQ0Y7QUFDRjtBQUFBa0ssRUFBQSxHQXBiYXZMO0FBQUFBO0FBQUFBIiwibmFtZXMiOlsiVEhSRUUiLCJSZW5kZXJlciIsIlNjZW5lTWFuYWdlciIsIkNhbWVyYUNvbnRyb2xsZXIiLCJJbnB1dE1hbmFnZXIiLCJOZXR3b3JrTWFuYWdlciIsIkxvY2FsUGxheWVyIiwiUmVtb3RlUGxheWVyIiwiTW9uc3RlckVudGl0eSIsIkxvb3REcm9wRW50aXR5IiwiSHViV29ybGQiLCJtb3VudEhVRCIsIm1vdW50TlBDRGlhbG9nIiwic2hvd05QQ0RpYWxvZyIsImhpZGVOUENEaWFsb2ciLCJtb3VudE1pbmlNYXAiLCJtb3VudFNob3BQYW5lbCIsInNob3dTaG9wUGFuZWwiLCJoaWRlU2hvcFBhbmVsIiwibW91bnRJbnZlbnRvcnlQYW5lbCIsInRvZ2dsZUludmVudG9yeVBhbmVsIiwiaGlkZUludmVudG9yeVBhbmVsIiwibW91bnRTZXR0aW5nc01lbnUiLCJzaG93U2V0dGluZ3MiLCJoaWRlU2V0dGluZ3MiLCJpc1NldHRpbmdzT3BlbiIsIk11c2ljU3lzdGVtIiwiaW52ZW50b3J5TWFuYWdlciIsInNldE5ldHdvcmtNYW5hZ2VyIiwiQ0xJRU5UX0lOUFVUX1JBVEUiLCJHYW1lIiwicmVuZGVyZXIiLCJzY2VuZU1hbmFnZXIiLCJjYW1lcmEiLCJpbnB1dCIsIm5ldHdvcmsiLCJsb2NhbFBsYXllciIsInJlbW90ZVBsYXllcnMiLCJNYXAiLCJtb25zdGVycyIsImxvb3REcm9wcyIsImh1YldvcmxkIiwibXVzaWMiLCJjbG9jayIsIkNsb2NrIiwiZWxhcHNlZFRpbWUiLCJpbnB1dFRpbWVyIiwiaW5wdXRJbnRlcnZhbCIsImZwcyIsImZyYW1lQ291bnQiLCJmcHNUaW1lciIsImN1cnJlbnRSb29tIiwiaHVkU3RhdGUiLCJwbGF5ZXJOYW1lIiwicGxheWVyR2VuZGVyIiwicG9ydGFsQ29vbGRvd24iLCJucGNDb29sZG93biIsImlzTW92aW5nIiwicGF1c2VkIiwiY2FudmFzIiwiY29uc3RydWN0b3IiLCJ1aU92ZXJsYXkiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0TWluaW1hcERhdGEiLCJvblNvdW5kVG9nZ2xlIiwibXV0ZWQiLCJtdXRlIiwidW5tdXRlIiwib25SZXN1bWUiLCJ1bnBhdXNlIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJjb2RlIiwiaXNBbnlQYW5lbE9wZW4iLCJwYXVzZSIsIm5wY1Jvb3QiLCJzaG9wUm9vdCIsImludlJvb3QiLCJjaGlsZHJlbiIsImxlbmd0aCIsImlubmVySFRNTCIsImV4aXRQb2ludGVyTG9jayIsInJlcXVlc3RQb2ludGVyTG9jayIsImNvbm5lY3QiLCJnZW5kZXIiLCJvbk1lc3NhZ2UiLCJ0eXBlIiwiZGF0YSIsImhhbmRsZU1lc3NhZ2UiLCJzY2VuZSIsInJvb20iLCJqb2luUm9vbSIsIm5hbWUiLCJzZXR1cFJvb21MaXN0ZW5lcnMiLCJwbGF5SHViIiwic2V0dXBQb3N0UHJvY2Vzc2luZyIsInN0YXJ0TG9vcCIsInN0YXRlIiwicGxheWVycyIsIm9uQWRkIiwicGxheWVyIiwic2Vzc2lvbklkIiwiZ2V0U2Vzc2lvbklkIiwicmVtb3RlIiwidGFyZ2V0UG9zaXRpb24iLCJzZXQiLCJwb3NpdGlvbiIsIngiLCJ5IiwieiIsIm9uQ2hhbmdlIiwidGFyZ2V0Um90YXRpb24iLCJyb3RhdGlvbiIsIm9uUmVtb3ZlIiwiX3BsYXllciIsImdldCIsImRpc3Bvc2UiLCJkZWxldGUiLCJtb25zdGVyIiwiaWQiLCJlbnRpdHkiLCJkZWZJZCIsImhwIiwibWF4SHAiLCJfbW9uc3RlciIsImxvb3QiLCJpdGVtRGVmSWQiLCJyYXJpdHkiLCJfbG9vdCIsInN3aXRjaFJvb20iLCJyb29tVHlwZSIsIm9wdGlvbnMiLCJmb3JFYWNoIiwicCIsImNsZWFyIiwibSIsImwiLCJncm91cCIsInZpc2libGUiLCJwbGF5RHVuZ2VvbiIsImNvbnNvbGUiLCJsb2ciLCJsZXZlbCIsIml0ZW0iLCJhZGRJdGVtIiwicGxheWVySWQiLCJzZXRGdWxsIiwiaXRlbXMiLCJnb2xkIiwic2V0R29sZCIsInRvdGFsIiwiZXJyb3IiLCJyZW1vdmVJdGVtIiwiaW5zdGFuY2VJZCIsImxvb3AiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJkdCIsImdldERlbHRhIiwidXBkYXRlIiwicmVuZGVyIiwiTWF0aCIsIm1heCIsIm1vdXNlIiwiY29uc3VtZU1vdXNlIiwib25Nb3VzZU1vdmUiLCJkeCIsImR5IiwiZ2V0SW5wdXQiLCJnZXRZYXciLCJhcHBseUlucHV0Iiwic2VuZElucHV0IiwiZm9yd2FyZCIsImJhY2t3YXJkIiwibGVmdCIsInJpZ2h0IiwiZ2V0Um9vbSIsIm15U3RhdGUiLCJyZWNvbmNpbGUiLCJsYXN0UHJvY2Vzc2VkSW5wdXQiLCJzdGF0cyIsIm1hbmEiLCJtYXhNYW5hIiwieHAiLCJ4cFRvTmV4dCIsImdldEdvbGQiLCJwbGF5ZXJDb3VudCIsInNpemUiLCJjaGVja0ludGVyYWN0aW9ucyIsInBvcyIsImlzS2V5IiwicG9ydGFsRGlzdCIsImRpc3RhbmNlVG8iLCJmb3Jlc3RQb3J0YWxQb3NpdGlvbiIsImR1bmdlb25JZCIsIm5wYyIsIm5wY1Bvc2l0aW9ucyIsImRpc3QiLCJkaWFsb2ciLCJjbG9zZXN0SWQiLCJjbG9zZXN0RGlzdCIsIm1lc2giLCJzZW5kTWVzc2FnZSIsImxvb3RJZCIsInJwIiwicHVzaCIsIm5wY3MiLCJwb3J0YWxzIiwiY29sb3IiLCJwbGF5ZXJYIiwicGxheWVyWiIsInBsYXllcllhdyIsIl9jIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIkdhbWUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuL2NvcmUvUmVuZGVyZXIuanMnO1xuaW1wb3J0IHsgU2NlbmVNYW5hZ2VyIH0gZnJvbSAnLi9jb3JlL1NjZW5lTWFuYWdlci5qcyc7XG5pbXBvcnQgeyBDYW1lcmFDb250cm9sbGVyIH0gZnJvbSAnLi9jb3JlL0NhbWVyYUNvbnRyb2xsZXIuanMnO1xuaW1wb3J0IHsgSW5wdXRNYW5hZ2VyIH0gZnJvbSAnLi9jb3JlL0lucHV0TWFuYWdlci5qcyc7XG5pbXBvcnQgeyBOZXR3b3JrTWFuYWdlciwgdHlwZSBSb29tVHlwZSB9IGZyb20gJy4vbmV0d29yay9OZXR3b3JrTWFuYWdlci5qcyc7XG5pbXBvcnQgeyBMb2NhbFBsYXllciwgdHlwZSBHZW5kZXIgfSBmcm9tICcuL2VudGl0aWVzL0xvY2FsUGxheWVyLmpzJztcbmltcG9ydCB7IFJlbW90ZVBsYXllciB9IGZyb20gJy4vZW50aXRpZXMvUmVtb3RlUGxheWVyLmpzJztcbmltcG9ydCB7IE1vbnN0ZXJFbnRpdHkgfSBmcm9tICcuL2VudGl0aWVzL01vbnN0ZXIuanMnO1xuaW1wb3J0IHsgTG9vdERyb3BFbnRpdHkgfSBmcm9tICcuL2VudGl0aWVzL0xvb3REcm9wLmpzJztcbmltcG9ydCB7IEh1YldvcmxkIH0gZnJvbSAnLi93b3JsZC9IdWJXb3JsZC5qcyc7XG5pbXBvcnQgeyBtb3VudEhVRCwgdHlwZSBIVURTdGF0ZSB9IGZyb20gJy4vdWkvSFVELmpzJztcbmltcG9ydCB7IG1vdW50TlBDRGlhbG9nLCBzaG93TlBDRGlhbG9nLCBoaWRlTlBDRGlhbG9nIH0gZnJvbSAnLi91aS9OUENEaWFsb2cuanMnO1xuaW1wb3J0IHsgbW91bnRNaW5pTWFwLCB0eXBlIE1pbmltYXBEYXRhIH0gZnJvbSAnLi91aS9NaW5pTWFwLmpzJztcbmltcG9ydCB7IG1vdW50U2hvcFBhbmVsLCBzaG93U2hvcFBhbmVsLCBoaWRlU2hvcFBhbmVsIH0gZnJvbSAnLi91aS9TaG9wUGFuZWwuanMnO1xuaW1wb3J0IHsgbW91bnRJbnZlbnRvcnlQYW5lbCwgdG9nZ2xlSW52ZW50b3J5UGFuZWwsIGhpZGVJbnZlbnRvcnlQYW5lbCB9IGZyb20gJy4vdWkvSW52ZW50b3J5UGFuZWwuanMnO1xuaW1wb3J0IHsgbW91bnRTZXR0aW5nc01lbnUsIHNob3dTZXR0aW5ncywgaGlkZVNldHRpbmdzLCBpc1NldHRpbmdzT3BlbiB9IGZyb20gJy4vdWkvU2V0dGluZ3NNZW51LmpzJztcbmltcG9ydCB7IE11c2ljU3lzdGVtIH0gZnJvbSAnLi9zeXN0ZW1zL011c2ljU3lzdGVtLmpzJztcbmltcG9ydCB7IGludmVudG9yeU1hbmFnZXIgfSBmcm9tICcuL3N5c3RlbXMvSW52ZW50b3J5TWFuYWdlci5qcyc7XG5pbXBvcnQgeyBzZXROZXR3b3JrTWFuYWdlciB9IGZyb20gJy4vbmV0d29yay9hY3Rpb25zLmpzJztcbmltcG9ydCB7IENMSUVOVF9JTlBVVF9SQVRFIH0gZnJvbSAnQHNhYWIvc2hhcmVkJztcblxuZXhwb3J0IGNsYXNzIEdhbWUge1xuICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjtcbiAgcHJpdmF0ZSBzY2VuZU1hbmFnZXI6IFNjZW5lTWFuYWdlcjtcbiAgcHJpdmF0ZSBjYW1lcmE6IENhbWVyYUNvbnRyb2xsZXI7XG4gIHByaXZhdGUgaW5wdXQ6IElucHV0TWFuYWdlcjtcbiAgcHJpdmF0ZSBuZXR3b3JrOiBOZXR3b3JrTWFuYWdlcjtcblxuICBwcml2YXRlIGxvY2FsUGxheWVyOiBMb2NhbFBsYXllciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHJlbW90ZVBsYXllcnMgPSBuZXcgTWFwPHN0cmluZywgUmVtb3RlUGxheWVyPigpO1xuICBwcml2YXRlIG1vbnN0ZXJzID0gbmV3IE1hcDxzdHJpbmcsIE1vbnN0ZXJFbnRpdHk+KCk7XG4gIHByaXZhdGUgbG9vdERyb3BzID0gbmV3IE1hcDxzdHJpbmcsIExvb3REcm9wRW50aXR5PigpO1xuXG4gIHByaXZhdGUgaHViV29ybGQ6IEh1YldvcmxkIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgbXVzaWMgPSBuZXcgTXVzaWNTeXN0ZW0oKTtcblxuICBwcml2YXRlIGNsb2NrID0gbmV3IFRIUkVFLkNsb2NrKCk7XG4gIHByaXZhdGUgZWxhcHNlZFRpbWUgPSAwO1xuICBwcml2YXRlIGlucHV0VGltZXIgPSAwO1xuICBwcml2YXRlIGlucHV0SW50ZXJ2YWwgPSAxIC8gQ0xJRU5UX0lOUFVUX1JBVEU7XG4gIHByaXZhdGUgZnBzID0gMDtcbiAgcHJpdmF0ZSBmcmFtZUNvdW50ID0gMDtcbiAgcHJpdmF0ZSBmcHNUaW1lciA9IDA7XG5cbiAgcHJpdmF0ZSBjdXJyZW50Um9vbTogUm9vbVR5cGUgPSAnaHViJztcbiAgcHJpdmF0ZSBodWRTdGF0ZTogSFVEU3RhdGUgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBwbGF5ZXJOYW1lID0gJ0FkdmVudHVyZXInO1xuICBwcml2YXRlIHBsYXllckdlbmRlcjogR2VuZGVyID0gJ21hbGUnO1xuXG4gIHByaXZhdGUgcG9ydGFsQ29vbGRvd24gPSAwOyAvLyBwcmV2ZW50IHNwYW1cbiAgcHJpdmF0ZSBucGNDb29sZG93biA9IDA7XG4gIHByaXZhdGUgaXNNb3ZpbmcgPSBmYWxzZTtcbiAgcHJpdmF0ZSBwYXVzZWQgPSBmYWxzZTtcbiAgcHJpdmF0ZSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuXG4gIGNvbnN0cnVjdG9yKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICB0aGlzLmNhbnZhcyA9IGNhbnZhcztcbiAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFJlbmRlcmVyKGNhbnZhcyk7XG4gICAgdGhpcy5zY2VuZU1hbmFnZXIgPSBuZXcgU2NlbmVNYW5hZ2VyKCk7XG4gICAgdGhpcy5jYW1lcmEgPSBuZXcgQ2FtZXJhQ29udHJvbGxlcigpO1xuICAgIHRoaXMuaW5wdXQgPSBuZXcgSW5wdXRNYW5hZ2VyKGNhbnZhcyk7XG4gICAgdGhpcy5uZXR3b3JrID0gbmV3IE5ldHdvcmtNYW5hZ2VyKCk7XG5cbiAgICAvLyBXaXJlIHVwIG5ldHdvcmsgYWN0aW9ucyBoZWxwZXJcbiAgICBzZXROZXR3b3JrTWFuYWdlcih0aGlzLm5ldHdvcmspO1xuXG4gICAgLy8gU2V0dXAgVUlcbiAgICBjb25zdCB1aU92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndWktb3ZlcmxheScpITtcbiAgICBtb3VudEhVRCh1aU92ZXJsYXksICgpID0+IHRoaXMuaHVkU3RhdGUpO1xuICAgIG1vdW50TlBDRGlhbG9nKHVpT3ZlcmxheSk7XG4gICAgbW91bnRNaW5pTWFwKHVpT3ZlcmxheSwgKCkgPT4gdGhpcy5nZXRNaW5pbWFwRGF0YSgpKTtcbiAgICBtb3VudFNob3BQYW5lbCh1aU92ZXJsYXkpO1xuICAgIG1vdW50SW52ZW50b3J5UGFuZWwodWlPdmVybGF5KTtcbiAgICBtb3VudFNldHRpbmdzTWVudSh1aU92ZXJsYXksIHtcbiAgICAgIG9uU291bmRUb2dnbGU6IChtdXRlZCkgPT4ge1xuICAgICAgICBpZiAobXV0ZWQpIHRoaXMubXVzaWMubXV0ZSgpO1xuICAgICAgICBlbHNlIHRoaXMubXVzaWMudW5tdXRlKCk7XG4gICAgICB9LFxuICAgICAgb25SZXN1bWU6ICgpID0+IHRoaXMudW5wYXVzZSgpLFxuICAgIH0pO1xuXG4gICAgLy8gRVNDIHRvIGNsb3NlIHBhbmVscyAvIHRvZ2dsZSBwYXVzZVxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgIGlmIChlLmNvZGUgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgIGlmIChpc1NldHRpbmdzT3BlbigpKSB7XG4gICAgICAgICAgaGlkZVNldHRpbmdzKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0FueVBhbmVsT3BlbigpKSB7XG4gICAgICAgICAgaGlkZU5QQ0RpYWxvZygpO1xuICAgICAgICAgIGhpZGVTaG9wUGFuZWwoKTtcbiAgICAgICAgICBoaWRlSW52ZW50b3J5UGFuZWwoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChlLmNvZGUgPT09ICdLZXlJJyB8fCBlLmNvZGUgPT09ICdLZXlCJykge1xuICAgICAgICBpZiAoIXRoaXMucGF1c2VkKSB0b2dnbGVJbnZlbnRvcnlQYW5lbCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBpc0FueVBhbmVsT3BlbigpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiBhbnkgVUkgcGFuZWxzIGFyZSBjdXJyZW50bHkgc2hvd24gKGJ5IERPTSB2aXNpYmlsaXR5KVxuICAgIGNvbnN0IG5wY1Jvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbnBjLWRpYWxvZy1yb290Jyk7XG4gICAgY29uc3Qgc2hvcFJvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2hvcC1wYW5lbC1yb290Jyk7XG4gICAgY29uc3QgaW52Um9vdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnZlbnRvcnktcGFuZWwtcm9vdCcpO1xuICAgIHJldHVybiAhIShcbiAgICAgIChucGNSb290ICYmIG5wY1Jvb3QuY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiBucGNSb290LmlubmVySFRNTC5sZW5ndGggPiAxMCkgfHxcbiAgICAgIChzaG9wUm9vdCAmJiBzaG9wUm9vdC5jaGlsZHJlbi5sZW5ndGggPiAwICYmIHNob3BSb290LmlubmVySFRNTC5sZW5ndGggPiAxMCkgfHxcbiAgICAgIChpbnZSb290ICYmIGludlJvb3QuY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiBpbnZSb290LmlubmVySFRNTC5sZW5ndGggPiAxMClcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBwYXVzZSgpIHtcbiAgICB0aGlzLnBhdXNlZCA9IHRydWU7XG4gICAgc2hvd1NldHRpbmdzKCk7XG4gICAgZG9jdW1lbnQuZXhpdFBvaW50ZXJMb2NrKCk7XG4gIH1cblxuICBwcml2YXRlIHVucGF1c2UoKSB7XG4gICAgdGhpcy5wYXVzZWQgPSBmYWxzZTtcbiAgICB0aGlzLmNhbnZhcy5yZXF1ZXN0UG9pbnRlckxvY2soKTtcbiAgfVxuXG4gIGFzeW5jIGNvbm5lY3QocGxheWVyTmFtZTogc3RyaW5nLCBnZW5kZXI6IEdlbmRlciA9ICdtYWxlJykge1xuICAgIHRoaXMucGxheWVyTmFtZSA9IHBsYXllck5hbWU7XG4gICAgdGhpcy5wbGF5ZXJHZW5kZXIgPSBnZW5kZXI7XG4gICAgdGhpcy5uZXR3b3JrLm9uTWVzc2FnZSA9ICh0eXBlLCBkYXRhKSA9PiB0aGlzLmhhbmRsZU1lc3NhZ2UodHlwZSwgZGF0YSk7XG5cbiAgICAvLyBCdWlsZCBodWIgd29ybGRcbiAgICB0aGlzLmh1YldvcmxkID0gbmV3IEh1YldvcmxkKHRoaXMuc2NlbmVNYW5hZ2VyLnNjZW5lKTtcblxuICAgIGNvbnN0IHJvb20gPSBhd2FpdCB0aGlzLm5ldHdvcmsuam9pblJvb20oJ2h1YicsIHsgbmFtZTogcGxheWVyTmFtZSB9KTtcbiAgICB0aGlzLmxvY2FsUGxheWVyID0gbmV3IExvY2FsUGxheWVyKHRoaXMuc2NlbmVNYW5hZ2VyLnNjZW5lLCBnZW5kZXIpO1xuICAgIHRoaXMuc2V0dXBSb29tTGlzdGVuZXJzKHJvb20pO1xuICAgIHRoaXMuY3VycmVudFJvb20gPSAnaHViJztcbiAgICB0aGlzLm11c2ljLnBsYXlIdWIoKTtcblxuICAgIC8vIEluaXRpYWxpemUgcG9zdC1wcm9jZXNzaW5nIGFmdGVyIHNjZW5lIGlzIHNldCB1cFxuICAgIHRoaXMucmVuZGVyZXIuc2V0dXBQb3N0UHJvY2Vzc2luZyh0aGlzLnNjZW5lTWFuYWdlci5zY2VuZSwgdGhpcy5jYW1lcmEuY2FtZXJhKTtcblxuICAgIHRoaXMuc3RhcnRMb29wKCk7XG4gIH1cblxuICBwcml2YXRlIHNldHVwUm9vbUxpc3RlbmVycyhyb29tOiBhbnkpIHtcbiAgICByb29tLnN0YXRlLnBsYXllcnMub25BZGQoKHBsYXllcjogYW55LCBzZXNzaW9uSWQ6IHN0cmluZykgPT4ge1xuICAgICAgaWYgKHNlc3Npb25JZCA9PT0gdGhpcy5uZXR3b3JrLmdldFNlc3Npb25JZCgpKSByZXR1cm47XG4gICAgICBjb25zdCByZW1vdGUgPSBuZXcgUmVtb3RlUGxheWVyKHRoaXMuc2NlbmVNYW5hZ2VyLnNjZW5lLCBzZXNzaW9uSWQsIHBsYXllci5uYW1lKTtcbiAgICAgIHJlbW90ZS50YXJnZXRQb3NpdGlvbi5zZXQocGxheWVyLnBvc2l0aW9uLngsIHBsYXllci5wb3NpdGlvbi55LCBwbGF5ZXIucG9zaXRpb24ueik7XG4gICAgICB0aGlzLnJlbW90ZVBsYXllcnMuc2V0KHNlc3Npb25JZCwgcmVtb3RlKTtcblxuICAgICAgcGxheWVyLnBvc2l0aW9uLm9uQ2hhbmdlKCgpID0+IHtcbiAgICAgICAgcmVtb3RlLnRhcmdldFBvc2l0aW9uLnNldChwbGF5ZXIucG9zaXRpb24ueCwgcGxheWVyLnBvc2l0aW9uLnksIHBsYXllci5wb3NpdGlvbi56KTtcbiAgICAgICAgcmVtb3RlLnRhcmdldFJvdGF0aW9uID0gcGxheWVyLnJvdGF0aW9uO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByb29tLnN0YXRlLnBsYXllcnMub25SZW1vdmUoKF9wbGF5ZXI6IGFueSwgc2Vzc2lvbklkOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHJlbW90ZSA9IHRoaXMucmVtb3RlUGxheWVycy5nZXQoc2Vzc2lvbklkKTtcbiAgICAgIGlmIChyZW1vdGUpIHtcbiAgICAgICAgcmVtb3RlLmRpc3Bvc2UodGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUpO1xuICAgICAgICB0aGlzLnJlbW90ZVBsYXllcnMuZGVsZXRlKHNlc3Npb25JZCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBEdW5nZW9uLXNwZWNpZmljIGxpc3RlbmVyc1xuICAgIGlmIChyb29tLnN0YXRlLm1vbnN0ZXJzKSB7XG4gICAgICByb29tLnN0YXRlLm1vbnN0ZXJzLm9uQWRkKChtb25zdGVyOiBhbnksIGlkOiBzdHJpbmcpID0+IHtcbiAgICAgICAgY29uc3QgZW50aXR5ID0gbmV3IE1vbnN0ZXJFbnRpdHkodGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUsIGlkLCBtb25zdGVyLmRlZklkKTtcbiAgICAgICAgZW50aXR5LnRhcmdldFBvc2l0aW9uLnNldChtb25zdGVyLnBvc2l0aW9uLngsIG1vbnN0ZXIucG9zaXRpb24ueSwgbW9uc3Rlci5wb3NpdGlvbi56KTtcbiAgICAgICAgZW50aXR5LmhwID0gbW9uc3Rlci5ocDtcbiAgICAgICAgZW50aXR5Lm1heEhwID0gbW9uc3Rlci5tYXhIcDtcbiAgICAgICAgdGhpcy5tb25zdGVycy5zZXQoaWQsIGVudGl0eSk7XG5cbiAgICAgICAgbW9uc3Rlci5wb3NpdGlvbi5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgZW50aXR5LnRhcmdldFBvc2l0aW9uLnNldChtb25zdGVyLnBvc2l0aW9uLngsIG1vbnN0ZXIucG9zaXRpb24ueSwgbW9uc3Rlci5wb3NpdGlvbi56KTtcbiAgICAgICAgICBlbnRpdHkudGFyZ2V0Um90YXRpb24gPSBtb25zdGVyLnJvdGF0aW9uO1xuICAgICAgICB9KTtcbiAgICAgICAgbW9uc3Rlci5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgZW50aXR5LmhwID0gbW9uc3Rlci5ocDtcbiAgICAgICAgICBlbnRpdHkubWF4SHAgPSBtb25zdGVyLm1heEhwO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByb29tLnN0YXRlLm1vbnN0ZXJzLm9uUmVtb3ZlKChfbW9uc3RlcjogYW55LCBpZDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMubW9uc3RlcnMuZ2V0KGlkKTtcbiAgICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICAgIGVudGl0eS5kaXNwb3NlKHRoaXMuc2NlbmVNYW5hZ2VyLnNjZW5lKTtcbiAgICAgICAgICB0aGlzLm1vbnN0ZXJzLmRlbGV0ZShpZCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChyb29tLnN0YXRlLmxvb3REcm9wcykge1xuICAgICAgcm9vbS5zdGF0ZS5sb290RHJvcHMub25BZGQoKGxvb3Q6IGFueSwgaWQ6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBlbnRpdHkgPSBuZXcgTG9vdERyb3BFbnRpdHkoXG4gICAgICAgICAgdGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUsIGlkLCBsb290Lml0ZW1EZWZJZCwgbG9vdC5yYXJpdHksXG4gICAgICAgICAgbG9vdC54LCBsb290LnksIGxvb3QueixcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5sb290RHJvcHMuc2V0KGlkLCBlbnRpdHkpO1xuICAgICAgfSk7XG5cbiAgICAgIHJvb20uc3RhdGUubG9vdERyb3BzLm9uUmVtb3ZlKChfbG9vdDogYW55LCBpZDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMubG9vdERyb3BzLmdldChpZCk7XG4gICAgICAgIGlmIChlbnRpdHkpIHtcbiAgICAgICAgICBlbnRpdHkuZGlzcG9zZSh0aGlzLnNjZW5lTWFuYWdlci5zY2VuZSk7XG4gICAgICAgICAgdGhpcy5sb290RHJvcHMuZGVsZXRlKGlkKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgc3dpdGNoUm9vbShyb29tVHlwZTogUm9vbVR5cGUsIG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fSkge1xuICAgIC8vIENsZWFuIHVwXG4gICAgdGhpcy5yZW1vdGVQbGF5ZXJzLmZvckVhY2gocCA9PiBwLmRpc3Bvc2UodGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUpKTtcbiAgICB0aGlzLnJlbW90ZVBsYXllcnMuY2xlYXIoKTtcbiAgICB0aGlzLm1vbnN0ZXJzLmZvckVhY2gobSA9PiBtLmRpc3Bvc2UodGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUpKTtcbiAgICB0aGlzLm1vbnN0ZXJzLmNsZWFyKCk7XG4gICAgdGhpcy5sb290RHJvcHMuZm9yRWFjaChsID0+IGwuZGlzcG9zZSh0aGlzLnNjZW5lTWFuYWdlci5zY2VuZSkpO1xuICAgIHRoaXMubG9vdERyb3BzLmNsZWFyKCk7XG5cbiAgICAvLyBUb2dnbGUgaHViIHdvcmxkXG4gICAgaWYgKHRoaXMuaHViV29ybGQpIHtcbiAgICAgIHRoaXMuaHViV29ybGQuZ3JvdXAudmlzaWJsZSA9IHJvb21UeXBlID09PSAnaHViJztcbiAgICB9XG5cbiAgICBjb25zdCByb29tID0gYXdhaXQgdGhpcy5uZXR3b3JrLmpvaW5Sb29tKHJvb21UeXBlLCB7IC4uLm9wdGlvbnMsIG5hbWU6IHRoaXMucGxheWVyTmFtZSB9KTtcbiAgICB0aGlzLnNldHVwUm9vbUxpc3RlbmVycyhyb29tKTtcblxuICAgIGlmICh0aGlzLmxvY2FsUGxheWVyKSB7XG4gICAgICB0aGlzLmxvY2FsUGxheWVyLnBvc2l0aW9uLnNldCgwLCByb29tVHlwZSA9PT0gJ2h1YicgPyAwLjkxIDogMCwgcm9vbVR5cGUgPT09ICdkdW5nZW9uJyA/IC04IDogMTYpO1xuICAgIH1cblxuICAgIHRoaXMuY3VycmVudFJvb20gPSByb29tVHlwZTtcbiAgICB0aGlzLnBvcnRhbENvb2xkb3duID0gMTtcblxuICAgIC8vIFN3aXRjaCBtdXNpY1xuICAgIGlmIChyb29tVHlwZSA9PT0gJ2h1YicpIHRoaXMubXVzaWMucGxheUh1YigpO1xuICAgIGVsc2UgdGhpcy5tdXNpYy5wbGF5RHVuZ2VvbigpO1xuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVNZXNzYWdlKHR5cGU6IHN0cmluZywgZGF0YTogYW55KSB7XG4gICAgaWYgKHR5cGUgPT09ICdkYW1hZ2UnKSB7XG4gICAgICAvLyBUT0RPOiBmbG9hdGluZyBkYW1hZ2UgdGV4dFxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2xldmVsX3VwJykge1xuICAgICAgY29uc29sZS5sb2coYExldmVsIHVwISBOb3cgbGV2ZWwgJHtkYXRhLmxldmVsfWApO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2xvb3RfYWNxdWlyZWQnKSB7XG4gICAgICAvLyBkYXRhLml0ZW0gaXMgZnVsbCBJdGVtSW5zdGFuY2UgZnJvbSBzZXJ2ZXJcbiAgICAgIGlmIChkYXRhLml0ZW0pIHtcbiAgICAgICAgaW52ZW50b3J5TWFuYWdlci5hZGRJdGVtKGRhdGEuaXRlbSk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBQaWNrZWQgdXA6ICR7ZGF0YS5pdGVtLmRlZklkfSAoJHtkYXRhLml0ZW0ucmFyaXR5fSlgKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdwbGF5ZXJfZGllZCcpIHtcbiAgICAgIGlmIChkYXRhLnBsYXllcklkID09PSB0aGlzLm5ldHdvcmsuZ2V0U2Vzc2lvbklkKCkgJiYgdGhpcy5sb2NhbFBsYXllcikge1xuICAgICAgICB0aGlzLmxvY2FsUGxheWVyLnBvc2l0aW9uLnNldCgwLCAwLCAtOCk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnaW52ZW50b3J5X2Z1bGwnKSB7XG4gICAgICBpbnZlbnRvcnlNYW5hZ2VyLnNldEZ1bGwoZGF0YS5pdGVtcywgZGF0YS5nb2xkKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdnb2xkX2dhaW5lZCcpIHtcbiAgICAgIGludmVudG9yeU1hbmFnZXIuc2V0R29sZChkYXRhLnRvdGFsKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzaG9wX2J1eV9vaycpIHtcbiAgICAgIGludmVudG9yeU1hbmFnZXIuYWRkSXRlbShkYXRhLml0ZW0pO1xuICAgICAgaW52ZW50b3J5TWFuYWdlci5zZXRHb2xkKGRhdGEuZ29sZCk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSAnc2hvcF9idXlfZmFpbCcpIHtcbiAgICAgIGNvbnNvbGUubG9nKGBTaG9wIGJ1eSBmYWlsZWQ6ICR7ZGF0YS5lcnJvcn1gKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdzaG9wX3NlbGxfb2snKSB7XG4gICAgICBpbnZlbnRvcnlNYW5hZ2VyLnJlbW92ZUl0ZW0oZGF0YS5pbnN0YW5jZUlkKTtcbiAgICAgIGludmVudG9yeU1hbmFnZXIuc2V0R29sZChkYXRhLmdvbGQpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3Nob3Bfc2VsbF9mYWlsJykge1xuICAgICAgY29uc29sZS5sb2coYFNob3Agc2VsbCBmYWlsZWQ6ICR7ZGF0YS5lcnJvcn1gKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXJ0TG9vcCgpIHtcbiAgICBjb25zdCBsb29wID0gKCkgPT4ge1xuICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAgICAgY29uc3QgZHQgPSB0aGlzLmNsb2NrLmdldERlbHRhKCk7XG4gICAgICB0aGlzLmVsYXBzZWRUaW1lICs9IGR0O1xuICAgICAgdGhpcy51cGRhdGUoZHQpO1xuICAgICAgdGhpcy5yZW5kZXJlci5yZW5kZXIodGhpcy5zY2VuZU1hbmFnZXIuc2NlbmUsIHRoaXMuY2FtZXJhLmNhbWVyYSk7XG4gICAgfTtcbiAgICBsb29wKCk7XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZShkdDogbnVtYmVyKSB7XG4gICAgLy8gRlBTXG4gICAgdGhpcy5mcmFtZUNvdW50Kys7XG4gICAgdGhpcy5mcHNUaW1lciArPSBkdDtcbiAgICBpZiAodGhpcy5mcHNUaW1lciA+PSAxKSB7XG4gICAgICB0aGlzLmZwcyA9IHRoaXMuZnJhbWVDb3VudDtcbiAgICAgIHRoaXMuZnJhbWVDb3VudCA9IDA7XG4gICAgICB0aGlzLmZwc1RpbWVyID0gMDtcbiAgICB9XG5cbiAgICAvLyBTa2lwIGdhbWUgbG9naWMgd2hlbiBwYXVzZWQgKHJlbmRlcmluZyBjb250aW51ZXMpXG4gICAgaWYgKHRoaXMucGF1c2VkKSByZXR1cm47XG5cbiAgICAvLyBDb29sZG93bnNcbiAgICB0aGlzLnBvcnRhbENvb2xkb3duID0gTWF0aC5tYXgoMCwgdGhpcy5wb3J0YWxDb29sZG93biAtIGR0KTtcbiAgICB0aGlzLm5wY0Nvb2xkb3duID0gTWF0aC5tYXgoMCwgdGhpcy5ucGNDb29sZG93biAtIGR0KTtcblxuICAgIC8vIE1vdXNlIGxvb2tcbiAgICBjb25zdCBtb3VzZSA9IHRoaXMuaW5wdXQuY29uc3VtZU1vdXNlKCk7XG4gICAgdGhpcy5jYW1lcmEub25Nb3VzZU1vdmUobW91c2UuZHgsIG1vdXNlLmR5KTtcblxuICAgIC8vIElucHV0XG4gICAgdGhpcy5pbnB1dFRpbWVyICs9IGR0O1xuICAgIGlmICh0aGlzLmlucHV0VGltZXIgPj0gdGhpcy5pbnB1dEludGVydmFsICYmIHRoaXMubG9jYWxQbGF5ZXIpIHtcbiAgICAgIHRoaXMuaW5wdXRUaW1lciA9IDA7XG4gICAgICBjb25zdCBpbnB1dCA9IHRoaXMuaW5wdXQuZ2V0SW5wdXQodGhpcy5jYW1lcmEuZ2V0WWF3KCksIHRoaXMuaW5wdXRJbnRlcnZhbCk7XG4gICAgICB0aGlzLmxvY2FsUGxheWVyLmFwcGx5SW5wdXQoaW5wdXQpO1xuICAgICAgdGhpcy5uZXR3b3JrLnNlbmRJbnB1dChpbnB1dCk7XG5cbiAgICAgIHRoaXMuaXNNb3ZpbmcgPSBpbnB1dC5mb3J3YXJkIHx8IGlucHV0LmJhY2t3YXJkIHx8IGlucHV0LmxlZnQgfHwgaW5wdXQucmlnaHQ7XG4gICAgfVxuXG4gICAgLy8gUmVjb25jaWxlXG4gICAgY29uc3Qgcm9vbSA9IHRoaXMubmV0d29yay5nZXRSb29tKCk7XG4gICAgaWYgKHJvb20gJiYgdGhpcy5sb2NhbFBsYXllcikge1xuICAgICAgY29uc3QgbXlTdGF0ZSA9IHJvb20uc3RhdGUucGxheWVycz8uZ2V0KHRoaXMubmV0d29yay5nZXRTZXNzaW9uSWQoKSk7XG4gICAgICBpZiAobXlTdGF0ZSkge1xuICAgICAgICB0aGlzLmxvY2FsUGxheWVyLnJlY29uY2lsZShcbiAgICAgICAgICBteVN0YXRlLnBvc2l0aW9uLngsXG4gICAgICAgICAgbXlTdGF0ZS5wb3NpdGlvbi56LFxuICAgICAgICAgIG15U3RhdGUubGFzdFByb2Nlc3NlZElucHV0LFxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuaHVkU3RhdGUgPSB7XG4gICAgICAgICAgaHA6IG15U3RhdGUuc3RhdHM/LmhwID8/IDEwMCxcbiAgICAgICAgICBtYXhIcDogbXlTdGF0ZS5zdGF0cz8ubWF4SHAgPz8gMTAwLFxuICAgICAgICAgIG1hbmE6IG15U3RhdGUuc3RhdHM/Lm1hbmEgPz8gNTAsXG4gICAgICAgICAgbWF4TWFuYTogbXlTdGF0ZS5zdGF0cz8ubWF4TWFuYSA/PyA1MCxcbiAgICAgICAgICBsZXZlbDogbXlTdGF0ZS5zdGF0cz8ubGV2ZWwgPz8gMSxcbiAgICAgICAgICB4cDogbXlTdGF0ZS5zdGF0cz8ueHAgPz8gMCxcbiAgICAgICAgICB4cFRvTmV4dDogbXlTdGF0ZS5zdGF0cz8ueHBUb05leHQgPz8gMTAwLFxuICAgICAgICAgIGdvbGQ6IGludmVudG9yeU1hbmFnZXIuZ2V0R29sZCgpLFxuICAgICAgICAgIHBsYXllckNvdW50OiByb29tLnN0YXRlLnBsYXllcnM/LnNpemUgPz8gMCxcbiAgICAgICAgICByb29tVHlwZTogdGhpcy5jdXJyZW50Um9vbSxcbiAgICAgICAgICBmcHM6IHRoaXMuZnBzLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSBlbnRpdGllc1xuICAgIHRoaXMubG9jYWxQbGF5ZXI/LnVwZGF0ZShkdCwgdGhpcy5lbGFwc2VkVGltZSwgdGhpcy5pc01vdmluZyk7XG4gICAgdGhpcy5yZW1vdGVQbGF5ZXJzLmZvckVhY2gocCA9PiBwLnVwZGF0ZShkdCkpO1xuICAgIHRoaXMubW9uc3RlcnMuZm9yRWFjaChtID0+IG0udXBkYXRlKGR0KSk7XG4gICAgdGhpcy5sb290RHJvcHMuZm9yRWFjaChsID0+IGwudXBkYXRlKGR0KSk7XG5cbiAgICAvLyBDYW1lcmEgKEZvcnRuaXRlLXN0eWxlIHNtb290aCBmb2xsb3cpXG4gICAgaWYgKHRoaXMubG9jYWxQbGF5ZXIpIHtcbiAgICAgIHRoaXMuY2FtZXJhLnVwZGF0ZSh0aGlzLmxvY2FsUGxheWVyLnBvc2l0aW9uLCBkdCk7XG4gICAgfVxuXG4gICAgLy8gSHViIHdvcmxkIGFuaW1hdGlvbnNcbiAgICBpZiAodGhpcy5odWJXb3JsZCAmJiB0aGlzLmN1cnJlbnRSb29tID09PSAnaHViJykge1xuICAgICAgdGhpcy5odWJXb3JsZC51cGRhdGUodGhpcy5lbGFwc2VkVGltZSwgdGhpcy5sb2NhbFBsYXllcj8ucG9zaXRpb24pO1xuICAgIH1cblxuICAgIC8vIEludGVyYWN0aW9uIGNoZWNrc1xuICAgIHRoaXMuY2hlY2tJbnRlcmFjdGlvbnMoKTtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tJbnRlcmFjdGlvbnMoKSB7XG4gICAgaWYgKCF0aGlzLmxvY2FsUGxheWVyKSByZXR1cm47XG4gICAgY29uc3QgcG9zID0gdGhpcy5sb2NhbFBsYXllci5wb3NpdGlvbjtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRSb29tID09PSAnaHViJyAmJiB0aGlzLmh1YldvcmxkKSB7XG4gICAgICAvLyBQb3J0YWw6IEUgdG8gZW50ZXJcbiAgICAgIGlmICh0aGlzLmlucHV0LmlzS2V5KCdLZXlFJykgJiYgdGhpcy5wb3J0YWxDb29sZG93biA8PSAwKSB7XG4gICAgICAgIGNvbnN0IHBvcnRhbERpc3QgPSBwb3MuZGlzdGFuY2VUbyh0aGlzLmh1YldvcmxkLmZvcmVzdFBvcnRhbFBvc2l0aW9uKTtcbiAgICAgICAgaWYgKHBvcnRhbERpc3QgPCA0KSB7XG4gICAgICAgICAgdGhpcy5zd2l0Y2hSb29tKCdkdW5nZW9uJywgeyBkdW5nZW9uSWQ6ICdmb3Jlc3QnIH0pO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBOUEM6IEUgdG8gaW50ZXJhY3RcbiAgICAgIGlmICh0aGlzLmlucHV0LmlzS2V5KCdLZXlFJykgJiYgdGhpcy5ucGNDb29sZG93biA8PSAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgbnBjIG9mIHRoaXMuaHViV29ybGQubnBjUG9zaXRpb25zKSB7XG4gICAgICAgICAgY29uc3QgZGlzdCA9IHBvcy5kaXN0YW5jZVRvKG5wYy5wb3NpdGlvbik7XG4gICAgICAgICAgaWYgKGRpc3QgPCAzKSB7XG4gICAgICAgICAgICBpZiAobnBjLm5hbWUgPT09ICdCbGFja3NtaXRoIFRvaXZvJykge1xuICAgICAgICAgICAgICBzaG93U2hvcFBhbmVsKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG93TlBDRGlhbG9nKG5wYy5uYW1lLCBucGMuZGlhbG9nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubnBjQ29vbGRvd24gPSAwLjU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5jdXJyZW50Um9vbSA9PT0gJ2R1bmdlb24nKSB7XG4gICAgICAvLyBGIHRvIHBpY2sgdXAgbG9vdFxuICAgICAgaWYgKHRoaXMuaW5wdXQuaXNLZXkoJ0tleUYnKSkge1xuICAgICAgICBsZXQgY2xvc2VzdElkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgICAgICAgbGV0IGNsb3Nlc3REaXN0ID0gMztcbiAgICAgICAgdGhpcy5sb290RHJvcHMuZm9yRWFjaCgobG9vdCwgaWQpID0+IHtcbiAgICAgICAgICBjb25zdCBkaXN0ID0gcG9zLmRpc3RhbmNlVG8obG9vdC5tZXNoLnBvc2l0aW9uKTtcbiAgICAgICAgICBpZiAoZGlzdCA8IGNsb3Nlc3REaXN0KSB7XG4gICAgICAgICAgICBjbG9zZXN0RGlzdCA9IGRpc3Q7XG4gICAgICAgICAgICBjbG9zZXN0SWQgPSBpZDtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoY2xvc2VzdElkKSB7XG4gICAgICAgICAgdGhpcy5uZXR3b3JrLnNlbmRNZXNzYWdlKCdwaWNrdXAnLCB7IGxvb3RJZDogY2xvc2VzdElkIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEVTQyBvciBwb3J0YWwgYmFjayB0byBodWIgKGZvciBub3csIHdhbGsgdG8gZWRnZSlcbiAgICAgIGlmICh0aGlzLmlucHV0LmlzS2V5KCdLZXlRJykgJiYgdGhpcy5wb3J0YWxDb29sZG93biA8PSAwKSB7XG4gICAgICAgIHRoaXMuc3dpdGNoUm9vbSgnaHViJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBnZXRNaW5pbWFwRGF0YSgpOiBNaW5pbWFwRGF0YSB8IG51bGwge1xuICAgIGlmICghdGhpcy5sb2NhbFBsYXllcikgcmV0dXJuIG51bGw7XG5cbiAgICBjb25zdCByZW1vdGVQbGF5ZXJzOiB7IHg6IG51bWJlcjsgejogbnVtYmVyIH1bXSA9IFtdO1xuICAgIHRoaXMucmVtb3RlUGxheWVycy5mb3JFYWNoKHJwID0+IHtcbiAgICAgIHJlbW90ZVBsYXllcnMucHVzaCh7IHg6IHJwLnRhcmdldFBvc2l0aW9uLngsIHo6IHJwLnRhcmdldFBvc2l0aW9uLnogfSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBucGNzOiB7IHg6IG51bWJlcjsgejogbnVtYmVyOyBuYW1lOiBzdHJpbmcgfVtdID0gW107XG4gICAgY29uc3QgcG9ydGFsczogeyB4OiBudW1iZXI7IHo6IG51bWJlcjsgY29sb3I6IHN0cmluZyB9W10gPSBbXTtcblxuICAgIGlmICh0aGlzLmN1cnJlbnRSb29tID09PSAnaHViJyAmJiB0aGlzLmh1YldvcmxkKSB7XG4gICAgICBmb3IgKGNvbnN0IG5wYyBvZiB0aGlzLmh1YldvcmxkLm5wY1Bvc2l0aW9ucykge1xuICAgICAgICBucGNzLnB1c2goeyB4OiBucGMucG9zaXRpb24ueCwgejogbnBjLnBvc2l0aW9uLnosIG5hbWU6IG5wYy5uYW1lIH0pO1xuICAgICAgfVxuICAgICAgcG9ydGFscy5wdXNoKFxuICAgICAgICB7IHg6IDAsIHo6IC0yNSwgY29sb3I6ICcjZmY4ODAwJyB9LCAgICAvLyBGb3Jlc3QgcG9ydGFsXG4gICAgICAgIHsgeDogLTEwLCB6OiAtMjUsIGNvbG9yOiAnI2ZmODgwMCcgfSwgICAvLyBJY2UgQ2F2ZXNcbiAgICAgICAgeyB4OiAxMCwgejogLTI1LCBjb2xvcjogJyNmZjg4MDAnIH0sICAgIC8vIFZvbGNhbm9cbiAgICAgICAgeyB4OiAtMTIsIHo6IC01LCBjb2xvcjogJyNmZmRkMDAnIH0sICAgIC8vIFNob3BcbiAgICAgICAgeyB4OiAxNSwgejogLTgsIGNvbG9yOiAnI2ZmNDQ0NCcgfSwgICAgIC8vIFB2UCBBcmVuYVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBtb25zdGVyczogeyB4OiBudW1iZXI7IHo6IG51bWJlciB9W10gPSBbXTtcbiAgICB0aGlzLm1vbnN0ZXJzLmZvckVhY2gobSA9PiB7XG4gICAgICBtb25zdGVycy5wdXNoKHsgeDogbS50YXJnZXRQb3NpdGlvbi54LCB6OiBtLnRhcmdldFBvc2l0aW9uLnogfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgcGxheWVyWDogdGhpcy5sb2NhbFBsYXllci5wb3NpdGlvbi54LFxuICAgICAgcGxheWVyWjogdGhpcy5sb2NhbFBsYXllci5wb3NpdGlvbi56LFxuICAgICAgcGxheWVyWWF3OiB0aGlzLmNhbWVyYS5nZXRZYXcoKSxcbiAgICAgIHJlbW90ZVBsYXllcnMsXG4gICAgICBucGNzLFxuICAgICAgcG9ydGFscyxcbiAgICAgIG1vbnN0ZXJzLFxuICAgICAgcm9vbVR5cGU6IHRoaXMuY3VycmVudFJvb20sXG4gICAgfTtcbiAgfVxufVxuIl0sImZpbGUiOiJDOi9Vc2Vycy9rYXBwdS9zYWFiL2NsaWVudC9zcmMvR2FtZS50cyJ9